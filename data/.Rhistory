tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	print(colMeans(rgb))#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	print(colMeans(rgb))#
	points3d(colMeans(rgb), col = "black", size = 8)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	points3d(colMeans(rgb), col = "black", size = 8)#
	print(colMeans(rgb))#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	points3d(colMeans(rgb), col = "black", size = 8)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	ans <- t(pca$rotation) %*% pca$x#
	print(ans)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	ans <- pca$rotation %*% pca$x#
	print(ans)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	ans <- pca$rotation %*% t(pca$x)#
	print(ans)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	ans <- pca$rotation %*% t(pca$x)#
	print(ans)#
	ans2 <- ans[,1] + colMeans(rgb)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
	print(summary(pca))#
	str(pca)#
	print(pca$x)#
	print(colMeans(rgb))#
	ans <- pca$rotation %*% t(pca$x)#
	print(ans)#
	ans2 <- ans[,1] + colMeans(rgb)#
	print(ans2)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	pca <- prcomp(rgb)#
#
	str(pca)#
	ans <- pca$x %*% pca$rotation#
	print(ans)#
	ans2 <- ans[,1] + colMeans(rgb)#
	print(ans2)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	str(rgb)#
	print(rgb)#
	pca <- prcomp(rgb)#
#
	str(pca)#
	ans <- pca$x %*% pca$rotation#
	print(ans)#
	ans2 <- ans[,1] + colMeans(rgb)#
	print(ans2)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
#
	print(rgb)#
	pca <- prcomp(rgb)#
#
	str(pca)#
	ans <- pca$x %*% pca$rotation#
	print(ans)#
	ans2 <- ans[,1] + colMeans(rgb)#
	print(ans2)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
#
	print(rgb)#
	pca <- prcomp(rgb)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation[1,] #
	print(orig.cntrd)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation[,1] #
	print(orig.cntrd)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x[,1] %*% pca$rotation[1,] #
	print(orig.cntrd)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x[,1] %*% pca$rotation[,1] #
	print(orig.cntrd)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
xy <- loadObject("load('~/Desktop/photoSpec/data/CVRLxyz.RData')")
xy <- loadObject('~/Desktop/photoSpec/data/CVRLxyz.RData')
str(xy)
library("rgl")
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation #
	print(orig.cntrd)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation #
#
	orig <- orig.cntrd[,1] + colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation #
#
	orig <- orig.cntrd + colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% t(pca$rotation) #
#
	orig <- orig.cntrd + colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% t(pca$rotation) #
	print(orig.cntrd)#
	orig <- orig.cntrd + colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig.cntrd <- pca$x %*% pca$rotation #
	print(orig.cntrd)#
	orig <- orig.cntrd + colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
?prcomp
?sd
tst <- c("#ff00fe", "#ff79fe", "#ffb5ff", "#ffdeff", "#feffff", "#ffffff")#
#
showCalColSpace <- function(calCols, sampCol, sampName) {#
#
	rgb <- col2rgb(calCols)#
	rgb <- t(rgb/255)#
	rgb <- as.data.frame(rgb)#
	names(rgb) <- c("x", "y", "z")#
	pca <- prcomp(rgb)#
	str(pca)	#
	orig <- ((rgb + colMeans(rgb))%*%pca$rotation)%*%t(pca$rotation)*sapply(rgb, sd)+colMeans(rgb) #
	print(orig)#
	points3d(x = 0.0, y = 0.0, z = 0.0, col = "black", size = 8, alpha = 0.0)#
	points3d(x = 1.0, y = 1.0, z = 1.0, col = "black", size = 8, alpha = 0.0)#
	axes3d(box = TRUE, expand = 0.9)#
	text3d(x = 1.05, y = 1.05, z = 1.05,#
		texts = "white", adj = c(0, 0))#
	text3d(x = -0.05, y = -0.05, z = -0.05,#
		texts = "black", adj = c(1, 1))#
	title3d(xlab = "red", ylab = "green", zlab = "blue")#
	points3d(rgb, col = calCols, size = 5)#
	demo <- data.frame(x = runif(1), y = runif(1), z = runif(1))#
	dc <- paste("#", as.hexmode(floor(demo$x*255)),#
		as.hexmode(floor(demo$y*255)), as.hexmode(floor(demo$z*255)), sep = "")#
	points3d(demo, size = 8, col = dc)#
	rgb#
	}
showCalColSpace(tst)
library("grid")
library("splancs")
library("R.utils")
plotCIEchrom <- function(gradient = NULL, colSpace = "sRGB", ff = 1.0,#
	opts = c("D65", "specLocus", "purples", "sRGB"), ...) {#
	Lxyz <- loadObject("CVRLxyz.RData")#
	if (!is.null(gradient)) {#
		if (!(colSpace == "sRGB") || (colSpace == "Apple RGB")) stop("colSpace must be sRGB or Apple RGB")#
		message("I'm painting a beautiful gradient, please give me a moment...")#
		xx <- seq(-0.1, 0.9, 0.002) #
		yy <- seq(0.9, -0.1, -0.002) #
		xyz <- expand.grid(xx,yy)#
		names(xyz) <- c("x", "y")#
		if (gradient == "sl") grad <- Lxyz#
		if (!gradient == "sl") grad <- getGamutValues(gradient)#
		insideL <- inout(xyz, grad, bound = TRUE) #
		outsideL <-!insideL #
		xyz$z <- 1 - xyz$x - xyz$y#
		xyzrgb <- convertColor(xyz, from = "XYZ", to = colSpace)#
		xyzrgb <- xyzrgb*ff#
		xyzrgb[xyzrgb > 1] <- 1.0#
		xyzrgb[outsideL,] <- 1.0 #
		fin <- array(dim = c(length(xx), length(yy), 3))#
		names(fin) <- c("x", "y", "rgb")#
		mr <- matrix(data = xyzrgb[,1], ncol = length(xx), byrow = FALSE)#
		mg <- matrix(data = xyzrgb[,2], ncol = length(xx), byrow = FALSE)#
		mb <- matrix(data = xyzrgb[,3], ncol = length(xx), byrow = FALSE)#
		fin[,,1] <- mr#
		fin[,,2] <- mg#
		fin[,,3] <- mb#
		fin <- aperm(fin, c(2,1,3)) #
		finras <- as.raster(fin)#
		}#
	off <- 0.1 #
	Lxyz$x <- Lxyz$x + off#
	Lxyz$y <- Lxyz$y + off#
	grid.text("1931 CIE Chromaticity Diagram", x = 0.5, y = 0.9,#
		gp = gpar(fontface = "bold", cex = 1.2))#
	grid.text(expression(italic(x)), x = 0.5, y = 0.05)#
	grid.text(expression(italic(y)), x = 0.05, y = 0.5, rot = 90)#
	pushViewport(viewport(width = 0.7, height = 0.7,#
		xscale = c(-0.1, 0.9), yscale = c(-0.1, 0.9)))#
	grid.raster(finras, x = 0.5, y = 0.5, interpolate = FALSE, default.units = "npc")#
	grid.polygon(Lxyz$x, Lxyz$y)#
	grid.rect()#
	tickpos <- seq(0.0, 0.8, by = 0.1)#
	grid.xaxis(at = tickpos)#
	grid.yaxis(at = tickpos)#
	msg <- "Warning: the color gradient appearance\nwill vary with the device, surface\n& incident light used to view it\nand is not likely correct anywhere"#
	grid.text(msg, x = 0.98, y = 0.9, gp = gpar(fontface = "italic", cex = 0.9), just = "right")#
	sl <- c(100, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600)#
	labs <- c("400 nm  ", "475 nm  ", "500 nm  ", "  525 nm", "  550 nm",#
		"  575 nm", "  600 nm", "  625 nm", "  650 nm")#
	grid.points(x = Lxyz$x[sl], y = Lxyz$y[sl], gp = gpar(col = "black"),#
		size = unit(0.5, "char"), default.units = "npc")#
	grid.text(label = labs, Lxyz$x[sl], Lxyz$y[sl],#
		hjust = c(1, 1, 1, 0, 0, 0, 0, 0, 0),#
		vjust = c(1, 0, 0, 0, 0, 0, 0, 0, 1),#
		gp = gpar(cex = 0.75))#
	if ("D65" %in% opts) {#
		wh <- getWhiteValues("D65")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D65", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("D50" %in% opts) {#
		wh <- getWhiteValues("D50")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D50", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("C" %in% opts) {#
		wh <- getWhiteValues("C")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  C", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("E" %in% opts) {#
		wh <- getWhiteValues("E")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  E", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
	if ("sRGB" %in% opts) {#
		g <- getGamutValues("sRGB")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("SWOP" %in% opts) {#
		g <- getGamutValues("SWOP")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Apple" %in% opts) {#
		g <- getGamutValues("Apple")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("NTSC" %in% opts) {#
		g <- getGamutValues("NTSC")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Adobe" %in% opts) {#
		g <- getGamutValues("Adobe")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("CIE" %in% opts) {#
		g <- getGamutValues("CIE")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
	if ("specLocus" %in% opts) {#
		grid.text(0.75, 0.55, label = "spectral\nlocus", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.73, 0.53, 0.61, 0.41, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
		}#
	if ("purples" %in% opts) {#
		grid.text(0.65, 0.05, label = "line of\npurples", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.63, 0.07, 0.5, 0.17, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
#
		}#
#
	}
getwd()
getGamutValues <- function(gamut) {#
	if (gamut == "Apple") { #
		x <- c(0.640, 0.300, 0.150)#
		y <- c(0.330, 0.600, 0.060)#
		ans <- data.frame(x, y)#
		}#
	if (gamut == "CIE") { #
		x <- c(0.735, 0.274, 0.167)#
		y <- c(0.265, 0.717, 0.009)#
		ans <- data.frame(x, y)#
		}#
#
	if (gamut == "Adobe") { #
		x <- c(0.640, 0.210, 0.150)#
		y <- c(0.330, 0.600, 0.060)#
		ans <- data.frame(x, y)#
		}#
#
	if (gamut == "sRGB") { #
		x <- c(0.640, 0.300, 0.150)#
		y <- c(0.330, 0.600, 0.060)#
		ans <- data.frame(x, y)#
		}#
#
	if (gamut == "NTSC") { #
		x <- c(0.670, 0.210, 0.140)#
		y <- c(0.330, 0.710, 0.080)#
		ans <- data.frame(x, y)#
		}#
#
	if (gamut == "SWOP") { #
		x <- c(0.205, 0.172, 0.225, 0.430, 0.610, 0.470)#
		y <- c(0.125, 0.226, 0.540, 0.500, 0.320, 0.235)#
		ans <- data.frame(x, y)#
		}#
#
	ans#
	}
getWhiteValues <- function(white) {#
	if (white == "D65") ans <- data.frame(x = 0.3127, y = 0.3290)#
	if (white == "E") ans <- data.frame(x = 0.333, y = 0.333)#
	if (white == "C") ans <- data.frame(x = 0.3101, y = 0.3161)#
	if (white == "D50") ans <- data.frame(x = 0.3457, y = 0.3585)#
#
	ans#
	}
library("raster")
plotCIEchrom <- function(gradient = NULL, colSpace = "sRGB", ff = 1.0,#
	opts = c("D65", "specLocus", "purples", "sRGB"), ...) {#
	Lxyz <- loadObject("CVRLxyz.RData")#
	if (!is.null(gradient)) {#
		if (!(colSpace == "sRGB") || (colSpace == "Apple RGB")) stop("colSpace must be sRGB or Apple RGB")#
		message("I'm painting a beautiful gradient, please give me a moment...")#
		xx <- seq(-0.1, 0.9, 0.002) #
		yy <- seq(0.9, -0.1, -0.002) #
		xyz <- expand.grid(xx,yy)#
		names(xyz) <- c("x", "y")#
		if (gradient == "sl") grad <- Lxyz#
		if (!gradient == "sl") grad <- getGamutValues(gradient)#
		insideL <- inout(xyz, grad, bound = TRUE) #
		outsideL <-!insideL #
		xyz$z <- 1 - xyz$x - xyz$y#
		xyzrgb <- convertColor(xyz, from = "XYZ", to = colSpace)#
		xyzrgb <- xyzrgb*ff#
		xyzrgb[xyzrgb > 1] <- 1.0#
		xyzrgb[outsideL,] <- 1.0 #
		fin <- array(dim = c(length(xx), length(yy), 3))#
		names(fin) <- c("x", "y", "rgb")#
		mr <- matrix(data = xyzrgb[,1], ncol = length(xx), byrow = FALSE)#
		mg <- matrix(data = xyzrgb[,2], ncol = length(xx), byrow = FALSE)#
		mb <- matrix(data = xyzrgb[,3], ncol = length(xx), byrow = FALSE)#
		fin[,,1] <- mr#
		fin[,,2] <- mg#
		fin[,,3] <- mb#
		fin <- aperm(fin, c(2,1,3)) #
		finras <- as.raster(fin)#
		}#
	off <- 0.1 #
	Lxyz$x <- Lxyz$x + off#
	Lxyz$y <- Lxyz$y + off#
	grid.text("1931 CIE Chromaticity Diagram", x = 0.5, y = 0.9,#
		gp = gpar(fontface = "bold", cex = 1.2))#
	grid.text(expression(italic(x)), x = 0.5, y = 0.05)#
	grid.text(expression(italic(y)), x = 0.05, y = 0.5, rot = 90)#
	pushViewport(viewport(width = 0.7, height = 0.7,#
		xscale = c(-0.1, 0.9), yscale = c(-0.1, 0.9)))#
	if (!is.null(gradient)) {#
		grid.raster(finras, x = 0.5, y = 0.5, interpolate = FALSE, default.units = "npc")#
		}#
	grid.polygon(Lxyz$x, Lxyz$y)#
	grid.rect()#
	tickpos <- seq(0.0, 0.8, by = 0.1)#
	grid.xaxis(at = tickpos)#
	grid.yaxis(at = tickpos)#
	msg <- "Warning: the color gradient appearance\nwill vary with the device, surface\n& incident light used to view it\nand is not likely correct anywhere"#
	grid.text(msg, x = 0.98, y = 0.9, gp = gpar(fontface = "italic", cex = 0.9), just = "right")#
	sl <- c(100, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600)#
	labs <- c("400 nm  ", "475 nm  ", "500 nm  ", "  525 nm", "  550 nm",#
		"  575 nm", "  600 nm", "  625 nm", "  650 nm")#
	grid.points(x = Lxyz$x[sl], y = Lxyz$y[sl], gp = gpar(col = "black"),#
		size = unit(0.5, "char"), default.units = "npc")#
	grid.text(label = labs, Lxyz$x[sl], Lxyz$y[sl],#
		hjust = c(1, 1, 1, 0, 0, 0, 0, 0, 0),#
		vjust = c(1, 0, 0, 0, 0, 0, 0, 0, 1),#
		gp = gpar(cex = 0.75))#
	if ("D65" %in% opts) {#
		wh <- getWhiteValues("D65")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D65", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("D50" %in% opts) {#
		wh <- getWhiteValues("D50")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D50", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("C" %in% opts) {#
		wh <- getWhiteValues("C")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  C", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("E" %in% opts) {#
		wh <- getWhiteValues("E")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  E", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
	if ("sRGB" %in% opts) {#
		g <- getGamutValues("sRGB")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("SWOP" %in% opts) {#
		g <- getGamutValues("SWOP")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Apple" %in% opts) {#
		g <- getGamutValues("Apple")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("NTSC" %in% opts) {#
		g <- getGamutValues("NTSC")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Adobe" %in% opts) {#
		g <- getGamutValues("Adobe")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("CIE" %in% opts) {#
		g <- getGamutValues("CIE")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
	if ("specLocus" %in% opts) {#
		grid.text(0.75, 0.55, label = "spectral\nlocus", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.73, 0.53, 0.61, 0.41, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
		}#
	if ("purples" %in% opts) {#
		grid.text(0.65, 0.05, label = "line of\npurples", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.63, 0.07, 0.5, 0.17, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
#
		}#
#
	}
plotCIEchrom <- function(gradient = NULL, colSpace = "sRGB", ff = 1.0,#
	opts = c("D65", "specLocus", "purples", "sRGB"), ...) {#
	Lxyz <- loadObject("CVRLxyz.RData")#
	if (!is.null(gradient)) {#
		if (!(colSpace == "sRGB") || (colSpace == "Apple RGB")) stop("colSpace must be sRGB or Apple RGB")#
		message("I'm painting a beautiful gradient, please give me a moment...")#
		xx <- seq(-0.1, 0.9, 0.002) #
		yy <- seq(0.9, -0.1, -0.002) #
		xyz <- expand.grid(xx,yy)#
		names(xyz) <- c("x", "y")#
		if (gradient == "sl") grad <- Lxyz#
		if (!gradient == "sl") grad <- getGamutValues(gradient)#
		insideL <- inout(xyz, grad, bound = TRUE) #
		outsideL <-!insideL #
		xyz$z <- 1 - xyz$x - xyz$y#
		xyzrgb <- convertColor(xyz, from = "XYZ", to = colSpace)#
		xyzrgb <- xyzrgb*ff#
		xyzrgb[xyzrgb > 1] <- 1.0#
		xyzrgb[outsideL,] <- 1.0 #
		fin <- array(dim = c(length(xx), length(yy), 3))#
		names(fin) <- c("x", "y", "rgb")#
		mr <- matrix(data = xyzrgb[,1], ncol = length(xx), byrow = FALSE)#
		mg <- matrix(data = xyzrgb[,2], ncol = length(xx), byrow = FALSE)#
		mb <- matrix(data = xyzrgb[,3], ncol = length(xx), byrow = FALSE)#
		fin[,,1] <- mr#
		fin[,,2] <- mg#
		fin[,,3] <- mb#
		fin <- aperm(fin, c(2,1,3)) #
		finras <- as.raster(fin)#
		}#
	off <- 0.1 #
	Lxyz$x <- Lxyz$x + off#
	Lxyz$y <- Lxyz$y + off#
	grid.text("1931 CIE Chromaticity Diagram", x = 0.5, y = 0.9,#
		gp = gpar(fontface = "bold", cex = 1.2))#
	grid.text(expression(italic(x)), x = 0.5, y = 0.05)#
	grid.text(expression(italic(y)), x = 0.05, y = 0.5, rot = 90)#
	pushViewport(viewport(width = 0.7, height = 0.7,#
		xscale = c(-0.1, 0.9), yscale = c(-0.1, 0.9)))#
	if (!is.null(gradient)) {#
		grid.raster(finras, x = 0.5, y = 0.5, interpolate = FALSE, default.units = "npc")#
		msg <- "Warning: the color gradient appearance\nwill vary with the device, surface\n& incident light used to view it\nand is not likely correct anywhere"#
		grid.text(msg, x = 0.98, y = 0.9, gp = gpar(fontface = "italic", cex = 0.9), just = "right")#
		}#
	grid.polygon(Lxyz$x, Lxyz$y)#
	grid.rect()#
	tickpos <- seq(0.0, 0.8, by = 0.1)#
	grid.xaxis(at = tickpos)#
	grid.yaxis(at = tickpos)#
	sl <- c(100, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600)#
	labs <- c("400 nm  ", "475 nm  ", "500 nm  ", "  525 nm", "  550 nm",#
		"  575 nm", "  600 nm", "  625 nm", "  650 nm")#
	grid.points(x = Lxyz$x[sl], y = Lxyz$y[sl], gp = gpar(col = "black"),#
		size = unit(0.5, "char"), default.units = "npc")#
	grid.text(label = labs, Lxyz$x[sl], Lxyz$y[sl],#
		hjust = c(1, 1, 1, 0, 0, 0, 0, 0, 0),#
		vjust = c(1, 0, 0, 0, 0, 0, 0, 0, 1),#
		gp = gpar(cex = 0.75))#
	if ("D65" %in% opts) {#
		wh <- getWhiteValues("D65")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D65", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("D50" %in% opts) {#
		wh <- getWhiteValues("D50")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D50", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("C" %in% opts) {#
		wh <- getWhiteValues("C")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  C", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("E" %in% opts) {#
		wh <- getWhiteValues("E")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  E", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
	if ("sRGB" %in% opts) {#
		g <- getGamutValues("sRGB")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("SWOP" %in% opts) {#
		g <- getGamutValues("SWOP")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Apple" %in% opts) {#
		g <- getGamutValues("Apple")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("NTSC" %in% opts) {#
		g <- getGamutValues("NTSC")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Adobe" %in% opts) {#
		g <- getGamutValues("Adobe")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("CIE" %in% opts) {#
		g <- getGamutValues("CIE")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
	if ("specLocus" %in% opts) {#
		grid.text(0.75, 0.55, label = "spectral\nlocus", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.73, 0.53, 0.61, 0.41, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
		}#
	if ("purples" %in% opts) {#
		grid.text(0.65, 0.05, label = "line of\npurples", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.63, 0.07, 0.5, 0.17, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
#
		}#
#
	}
plotCIEchrom <- function(gradient = NULL, colSpace = "sRGB", ff = 1.0,#
	opts = c("D65", "specLocus", "purples", "sRGB"), ...) {#
	Lxyz <- loadObject("CVRLxyz.RData")#
	if (!is.null(gradient)) {#
		if (!(colSpace == "sRGB") || (colSpace == "Apple RGB")) stop("colSpace must be sRGB or Apple RGB")#
		message("I'm painting a beautiful gradient, please give me a moment...")#
		xx <- seq(-0.1, 0.9, 0.002) #
		yy <- seq(0.9, -0.1, -0.002) #
		xyz <- expand.grid(xx,yy)#
		names(xyz) <- c("x", "y")#
		if (gradient == "sl") grad <- Lxyz#
		if (!gradient == "sl") grad <- getGamutValues(gradient)#
		insideL <- inout(xyz, grad, bound = TRUE) #
		outsideL <-!insideL #
		xyz$z <- 1 - xyz$x - xyz$y#
		xyzrgb <- convertColor(xyz, from = "XYZ", to = colSpace)#
		xyzrgb <- xyzrgb*ff#
		xyzrgb[xyzrgb > 1] <- 1.0#
		xyzrgb[outsideL,] <- 1.0 #
		fin <- array(dim = c(length(xx), length(yy), 3))#
		names(fin) <- c("x", "y", "rgb")#
		mr <- matrix(data = xyzrgb[,1], ncol = length(xx), byrow = FALSE)#
		mg <- matrix(data = xyzrgb[,2], ncol = length(xx), byrow = FALSE)#
		mb <- matrix(data = xyzrgb[,3], ncol = length(xx), byrow = FALSE)#
		fin[,,1] <- mr#
		fin[,,2] <- mg#
		fin[,,3] <- mb#
		fin <- aperm(fin, c(2,1,3)) #
		finras <- as.raster(fin)#
		}#
	off <- 0.1 #
	Lxyz$x <- Lxyz$x + off#
	Lxyz$y <- Lxyz$y + off#
	grid.text("1931 CIE Chromaticity Diagram", x = 0.5, y = 0.9,#
		gp = gpar(fontface = "bold", cex = 1.2))#
	grid.text(expression(italic(x)), x = 0.5, y = 0.05)#
	grid.text(expression(italic(y)), x = 0.05, y = 0.5, rot = 90)#
	pushViewport(viewport(width = 0.7, height = 0.7,#
		xscale = c(-0.1, 0.9), yscale = c(-0.1, 0.9)))#
#
	if (!is.null(gradient)) {#
		grid.raster(finras, x = 0.5, y = 0.5, interpolate = FALSE, default.units = "npc")#
		msg <- "Warning: the color gradient appearance\nwill vary with the device, surface\n& incident light used to view it\nand is not likely correct anywhere"#
		grid.text(msg, x = 0.98, y = 0.9, gp = gpar(fontface = "italic", cex = 0.9),#
			just = "right")#
		}#
#
	grid.polygon(Lxyz$x, Lxyz$y)#
	grid.rect()#
	tickpos <- seq(0.0, 0.8, by = 0.1)#
	grid.xaxis(at = tickpos)#
	grid.yaxis(at = tickpos)#
	sl <- c(100, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600)#
	labs <- c("400 nm  ", "475 nm  ", "500 nm  ", "  525 nm", "  550 nm",#
		"  575 nm", "  600 nm", "  625 nm", "  650 nm")#
	grid.points(x = Lxyz$x[sl], y = Lxyz$y[sl], gp = gpar(col = "black"),#
		size = unit(0.5, "char"), default.units = "npc")#
	grid.text(label = labs, Lxyz$x[sl], Lxyz$y[sl],#
		hjust = c(1, 1, 1, 0, 0, 0, 0, 0, 0),#
		vjust = c(1, 0, 0, 0, 0, 0, 0, 0, 1),#
		gp = gpar(cex = 0.75))#
	if ("D65" %in% opts) {#
		wh <- getWhiteValues("D65")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D65", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("D50" %in% opts) {#
		wh <- getWhiteValues("D50")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D50", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("C" %in% opts) {#
		wh <- getWhiteValues("C")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  C", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("E" %in% opts) {#
		wh <- getWhiteValues("E")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  E", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
	if ("sRGB" %in% opts) {#
		g <- getGamutValues("sRGB")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("SWOP" %in% opts) {#
		g <- getGamutValues("SWOP")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Apple" %in% opts) {#
		g <- getGamutValues("Apple")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("NTSC" %in% opts) {#
		g <- getGamutValues("NTSC")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Adobe" %in% opts) {#
		g <- getGamutValues("Adobe")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("CIE" %in% opts) {#
		g <- getGamutValues("CIE")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
	if ("specLocus" %in% opts) {#
		grid.text(0.75, 0.55, label = "spectral\nlocus", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.73, 0.53, 0.61, 0.41, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
		}#
	if ("purples" %in% opts) {#
		grid.text(0.65, 0.05, label = "line of\npurples", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.63, 0.07, 0.5, 0.17, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
#
		}#
#
	}
plotCIEchrom <- function(gradient = NULL, colSpace = "sRGB", ff = 1.0,#
	opts = c("D65", "specLocus", "purples"), ...) {#
	Lxyz <- loadObject("CVRLxyz.RData")#
	if (!is.null(gradient)) {#
		if (!(colSpace == "sRGB") || (colSpace == "Apple RGB")) stop("colSpace must be sRGB or Apple RGB")#
		message("I'm painting a beautiful gradient, please give me a moment...")#
		xx <- seq(-0.1, 0.9, 0.002) #
		yy <- seq(0.9, -0.1, -0.002) #
		xyz <- expand.grid(xx,yy)#
		names(xyz) <- c("x", "y")#
		if (gradient == "sl") grad <- Lxyz#
		if (!gradient == "sl") grad <- getGamutValues(gradient)#
		insideL <- inout(xyz, grad, bound = TRUE) #
		outsideL <-!insideL #
		xyz$z <- 1 - xyz$x - xyz$y#
		xyzrgb <- convertColor(xyz, from = "XYZ", to = colSpace)#
		xyzrgb <- xyzrgb*ff#
		xyzrgb[xyzrgb > 1] <- 1.0#
		xyzrgb[outsideL,] <- 1.0 #
		fin <- array(dim = c(length(xx), length(yy), 3))#
		names(fin) <- c("x", "y", "rgb")#
		mr <- matrix(data = xyzrgb[,1], ncol = length(xx), byrow = FALSE)#
		mg <- matrix(data = xyzrgb[,2], ncol = length(xx), byrow = FALSE)#
		mb <- matrix(data = xyzrgb[,3], ncol = length(xx), byrow = FALSE)#
		fin[,,1] <- mr#
		fin[,,2] <- mg#
		fin[,,3] <- mb#
		fin <- aperm(fin, c(2,1,3)) #
		finras <- as.raster(fin)#
		}#
	off <- 0.1 #
	Lxyz$x <- Lxyz$x + off#
	Lxyz$y <- Lxyz$y + off#
	grid.text("1931 CIE Chromaticity Diagram", x = 0.5, y = 0.9,#
		gp = gpar(fontface = "bold", cex = 1.2))#
	grid.text(expression(italic(x)), x = 0.5, y = 0.05)#
	grid.text(expression(italic(y)), x = 0.05, y = 0.5, rot = 90)#
	pushViewport(viewport(width = 0.7, height = 0.7,#
		xscale = c(-0.1, 0.9), yscale = c(-0.1, 0.9)))#
#
	if (!is.null(gradient)) {#
		grid.raster(finras, x = 0.5, y = 0.5, interpolate = FALSE, default.units = "npc")#
		msg <- "Warning: the color gradient appearance\nwill vary with the device, surface\n& incident light used to view it\nand is not likely correct anywhere"#
		grid.text(msg, x = 0.98, y = 0.9, gp = gpar(fontface = "italic", cex = 0.9),#
			just = "right")#
		}#
#
	grid.polygon(Lxyz$x, Lxyz$y)#
	grid.rect()#
	tickpos <- seq(0.0, 0.8, by = 0.1)#
	grid.xaxis(at = tickpos)#
	grid.yaxis(at = tickpos)#
	sl <- c(100, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600)#
	labs <- c("400 nm  ", "475 nm  ", "500 nm  ", "  525 nm", "  550 nm",#
		"  575 nm", "  600 nm", "  625 nm", "  650 nm")#
	grid.points(x = Lxyz$x[sl], y = Lxyz$y[sl], gp = gpar(col = "black"),#
		size = unit(0.5, "char"), default.units = "npc")#
	grid.text(label = labs, Lxyz$x[sl], Lxyz$y[sl],#
		hjust = c(1, 1, 1, 0, 0, 0, 0, 0, 0),#
		vjust = c(1, 0, 0, 0, 0, 0, 0, 0, 1),#
		gp = gpar(cex = 0.75))#
	if ("D65" %in% opts) {#
		wh <- getWhiteValues("D65")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D65", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("D50" %in% opts) {#
		wh <- getWhiteValues("D50")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  D50", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("C" %in% opts) {#
		wh <- getWhiteValues("C")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  C", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
#
	if ("E" %in% opts) {#
		wh <- getWhiteValues("E")#
		grid.points(wh$x, wh$y, gp = gpar(col = "black"),#
			size = unit(0.5, "char"), default.units = "native")#
		grid.text(wh$x, wh$y, label = "  E", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		}#
	if ("sRGB" %in% opts) {#
		g <- getGamutValues("sRGB")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("SWOP" %in% opts) {#
		g <- getGamutValues("SWOP")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Apple" %in% opts) {#
		g <- getGamutValues("Apple")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("NTSC" %in% opts) {#
		g <- getGamutValues("NTSC")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("Adobe" %in% opts) {#
		g <- getGamutValues("Adobe")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
#
	if ("CIE" %in% opts) {#
		g <- getGamutValues("CIE")#
		grid.polygon(g$x, g$y, default.units = "native")#
		}#
	if ("specLocus" %in% opts) {#
		grid.text(0.75, 0.55, label = "spectral\nlocus", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.73, 0.53, 0.61, 0.41, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
		}#
	if ("purples" %in% opts) {#
		grid.text(0.65, 0.05, label = "line of\npurples", just = "left",#
			gp = gpar(cex = 0.75), default.units = "native")#
		grid.segments(0.63, 0.07, 0.5, 0.17, default.units = "native",#
			arrow = arrow(ends = "last", length = unit(0.025, "npc"),#
			angle = 15, type = "closed"))#
#
		}#
#
	}
plotCIEchrom()
plotCIEchrom(graident = "sl")
plotCIEchrom(gradient = "sl")
